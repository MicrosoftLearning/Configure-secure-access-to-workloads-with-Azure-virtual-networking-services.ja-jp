---
lab:
  title: '演習 01: 仮想ネットワークを作成して構成する。'
  module: Guided Project - Configure secure access to workloads with Azure virtual networking services
---

# 演習 01: 仮想ネットワークを作成して構成する。

## シナリオ

組織が Web ベースのアプリケーションを Azure に移行しています。 最初のタスクは、仮想ネットワークとサブネットを配置することです。 また、仮想ネットワークを安全にピアリングする必要もあります。 これらの要件を特定します。 
+ **app-vnet** と **hub-vnet** という 2 つの仮想ネットワークが必要です。 これにより、ハブとスポークのネットワーク アーキテクチャがシミュレートされます。 
+ app-vnet によってアプリケーションがホストされます。 この仮想ネットワークには 2 つのサブネットが必要です。 **フロントエンド サブネット**は Web サーバーをホストします。 **バックエンド サブネット**はデータベース サーバーをホストします。
+ hub-vnet には、ファイアウォール用のサブネットのみが必要です。 
+ 2 つの仮想ネットワークは、**仮想ネットワーク ピアリング** を使用して、安全かつ非公開の方法で相互に通信できる必要があります。 
+ 両方の仮想ネットワークは、同じリージョンに含める必要があります。 

## スキル タスク

+ 仮想ネットワークを作成します。
+ サブネットを作成します。
+ VNet ピアリングを構成する。

## アーキテクチャの図

![ピアリングされた 2 つの仮想ネットワークを示す図。](../Media/task-1.png)

## 演習の手順

**注**: このラボを完了するには、**共同作成者** RBAC ロールが割り当てられた [Azure サブスクリプション](https://azure.microsoft.com/free/)が必要です。 このラボでは、リソースの作成を求められたときに、指定されていないプロパティには既定値を使います。

### ハブとスポークの仮想ネットワークとサブネットを作成する

[Azure Virtual Network](https://learn.microsoft.com/azure/virtual-network/virtual-networks-overview) を使用すると、さまざまな種類の Azure リソースが相互、インターネット、およびオンプレミス ネットワークと安全に通信できます。 仮想ネットワーク内のすべての Azure リソースは、仮想ネットワーク内の[サブネット](https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-subnet?tabs=azure-portal)にデプロイされます。 

1. **Azure portal** - `https://portal.azure.com` にサインインします。
   
1. `Virtual Networks` を検索して選択します。
   
1. **[+ 作成]** を選択して **app-vnet** の構成を完了します。 この仮想ネットワークには、**フロントエンド**と**バックエンド**の 2 つのサブネットが必要です。 

    | プロパティ             | 値           |
    | :------------------- | :-------------- |
    | Resource group       | **RG1**         |
    | 仮想ネットワーク名 | `app-vnet`    |
    | リージョン               | **米国東部**     |
    | IPv4 アドレス空間   | **10.1.0.0/16** |
    | サブネット名          | `frontend`    |
    | サブネットのアドレス範囲 | **10.1.0.0/24** |
    | サブネット名          | `backend`     |
    | サブネットのアドレス範囲 | **10.1.1.0/24** |

    **注**: その他の設定は、既定値のままにしておきます。 完了したら、**[確認および作成]**、**[作成]** の順に選択します。
   
1. **Hub-vnet** 仮想ネットワーク構成を作成します。 この仮想ネットワークにはファイアウォール サブネットがあります。 

    | プロパティ             | 値                    |
    | :------------------- | :----------------------- |
    | Resource group       | **RG1**                  |
    | Name                 | `hub-vnet` |
    | リージョン               | **米国東部**              |
    | IPv4 アドレス空間   | **10.0.0.0/16**          |
    | サブネット名          | **AzureFirewallSubnet**  |
    | サブネットのアドレス範囲 | **10.0.0.0/24**          |

1. デプロイが完了したら、「仮想ネットワーク」を検索して選択します。

1. 仮想ネットワークとサブネットがデプロイされたことを確認します。 

### 仮想ネットワーク間のピア関係を構成する

Azure の 2 つ以上の仮想ネットワークにシームレスに接続するには、[仮想ネットワーク ピアリング](https://learn.microsoft.com/azure/virtual-network/virtual-network-peering-overview)を使用できます。 

1. `app-vnet` 仮想マシンを検索して選択します。
   
1. **[設定]** ブレードで **[ピアリング]** を選択します。
   
1. 仮想ネットワーク間のピアリングを**追加**します。 

    | プロパティ                                 | 値                          |
    | :--------------------------------------- | :----------------------------- |
    | リモート ピアリング リンク名              | `app-vnet-to-hub` |
    | 仮想ネットワーク    | `hub-vnet` |
    | ローカル仮想ネットワーク ピアリング リンク名 | `hub-to-app-vnet` |

    **注**: その他の設定は、既定値のままにしておきます。 **[追加]** を選択して、仮想ネットワーク ピアリングを作成します。

1. デプロイが完了したら、**ピアリングの状態**が **[接続済み]** であることを確認します。

## オンライン トレーニングでさらに学習する

+ [Azure 仮想ネットワークの概要](https://learn.microsoft.com/training/modules/introduction-to-azure-virtual-networks/)。 このモジュールでは、Azure ネットワーク サービスの設計と実装の方法について説明します。 仮想ネットワーク、パブリック IP とプライベート IP、DNS、仮想ネットワーク ピアリング、ルーティング、Azure Virtual Network NAT などを取り上げます。

## 要点

以上でこの演習は完了です。 重要なポイントを以下に示します。

+ Azure Virtual Network (VNet) は、安全で分離されたネットワーク環境をクラウド リソースに提供します。 リージョンごとのサブスクリプションごとに、複数の仮想ネットワークを作成できます。
+ 仮想ネットワークを設計する時は、VNet アドレス空間 (CIDR ブロック) が組織の他のネットワークの範囲と重複しないようにします。
+ サブネットとは、VNet 内の一定範囲の IP アドレスです。 VNet を異なるサイズの複数のサブネットに分割し、サブスクリプションの制限内での組織化とセキュリティに必要なだけいくつでもサブネットを作成できます。 各サブネットには、固有のアドレスの範囲を設定する必要があります。
+ Azure Firewall など、特定の Azure サービスには、独自のサブネットが必要です。
+ 仮想ネットワーク ピアリングを使用すると、2 つの Azure 仮想ネットワーク間をシームレスに接続できます。 仮想ネットワークは、接続において、見かけ上 1 つのネットワークとして機能します。
